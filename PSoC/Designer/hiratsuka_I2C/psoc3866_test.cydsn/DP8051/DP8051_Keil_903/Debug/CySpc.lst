C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 1   


C51 COMPILER V9.03, COMPILATION OF MODULE CYSPC
OBJECT MODULE PLACED IN .\DP8051\DP8051_Keil_903\Debug\CySpc.obj
COMPILER INVOKED BY: C:\Program Files\Cypress\PSoC Creator\2.2\PSoC Creator\import\keil\pk51\9.03\C51\BIN\c51.exe .\Gene
                    -rated_Source\PSoC3\CySpc.c NOIV LARGE MODDP2 OMF2 VB(1) PR(.\DP8051\DP8051_Keil_903\Debug\CySpc.lst) CD DB NOIP OT(2,SIZ
                    -E) DF(DEBUG) INCDIR(Generated_Source\PSoC3) OJ(.\DP8051\DP8051_Keil_903\Debug\CySpc.obj)

line level    source

   1          /*******************************************************************************
   2          * File Name: CySpc.c
   3          * Version 3.40
   4          *
   5          *  Description:
   6          *   Provides an API for the System Performance Component.
   7          *   The SPC functions are not meant to be called directly by the user
   8          *   application.
   9          *
  10          ********************************************************************************
  11          * Copyright 2008-2013, Cypress Semiconductor Corporation.  All rights reserved.
  12          * You may use this file only in accordance with the license, terms, conditions,
  13          * disclaimers, and limitations in the end user license agreement accompanying
  14          * the software package with which this file was provided.
  15          *******************************************************************************/
  16          
  17          #include "CySpc.h"
  18          
  19          #define CY_SPC_KEY_ONE                      (0xB6u)
  20          #define CY_SPC_KEY_TWO(x)                   ((uint8) (((uint16) 0xD3u) + ((uint16) (x))))
  21          
  22          /* Command Codes */
  23          #define CY_SPC_CMD_LD_BYTE                  (0x00u)
  24          #define CY_SPC_CMD_LD_MULTI_BYTE            (0x01u)
  25          #define CY_SPC_CMD_LD_ROW                   (0x02u)
  26          #define CY_SPC_CMD_RD_BYTE                  (0x03u)
  27          #define CY_SPC_CMD_RD_MULTI_BYTE            (0x04u)
  28          #define CY_SPC_CMD_WR_ROW                   (0x05u)
  29          #define CY_SPC_CMD_WR_USER_NVL              (0x06u)
  30          #define CY_SPC_CMD_PRG_ROW                  (0x07u)
  31          #define CY_SPC_CMD_ER_SECTOR                (0x08u)
  32          #define CY_SPC_CMD_ER_ALL                   (0x09u)
  33          #define CY_SPC_CMD_RD_HIDDEN                (0x0Au)
  34          #define CY_SPC_CMD_PRG_PROTECT              (0x0Bu)
  35          #define CY_SPC_CMD_CHECKSUM                 (0x0Cu)
  36          #define CY_SPC_CMD_DWNLD_ALGORITHM          (0x0Du)
  37          #define CY_SPC_CMD_GET_TEMP                 (0x0Eu)
  38          #define CY_SPC_CMD_GET_ADC                  (0x0Fu)
  39          #define CY_SPC_CMD_RD_NVL_VOLATILE          (0x10u)
  40          #define CY_SPC_CMD_SETUP_TS                 (0x11u)
  41          #define CY_SPC_CMD_DISABLE_TS               (0x12u)
  42          #define CY_SPC_CMD_ER_ROW                   (0x13u)
  43          
  44          /* Enable bit in Active and Alternate Active mode templates */
  45          #define PM_SPC_PM_EN                        (0x08u)
  46          
  47          /* Gate calls to the SPC. */
  48          uint8 SpcLockState = CY_SPC_UNLOCKED;
  49          
  50          
  51          #if(CY_PSOC5LP)
              
                  /***************************************************************************
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 2   

                  * The wait-state pipeline must be enabled prior to accessing the SPC
                  * register interface regardless of CPU frequency. The CySpcLock() saves
                  * current wait-state pipeline state and enables it. The CySpcUnlock()
                  * function, which must be called after SPC transaction, restores original
                  * state.
                  ***************************************************************************/
                  static uint8 spcWaitPipeBypass = 0u;
              
              #endif  /* (CY_PSOC5LP) */
  63          
  64          
  65          /*******************************************************************************
  66          * Function Name: CySpcStart
  67          ********************************************************************************
  68          * Summary:
  69          *  Starts the SPC.
  70          *
  71          * Parameters:
  72          *  None
  73          *
  74          * Return:
  75          *  None
  76          *
  77          *******************************************************************************/
  78          void CySpcStart(void) 
  79          {
  80   1          /* Save current global interrupt enable and disable it */
  81   1          uint8 interruptState = CyEnterCriticalSection();
  82   1      
  83   1          CY_SPC_PM_ACT_REG  |= PM_SPC_PM_EN;
  84   1          CY_SPC_PM_STBY_REG |= PM_SPC_PM_EN;
  85   1      
  86   1          /* Restore global interrupt enable state */
  87   1          CyExitCriticalSection(interruptState);
  88   1      }
  89          
  90          
  91          /*******************************************************************************
  92          * Function Name: CySpcStop
  93          ********************************************************************************
  94          * Summary:
  95          *  Stops the SPC.
  96          *
  97          * Parameters:
  98          *  None
  99          *
 100          * Return:
 101          *  None
 102          *
 103          *******************************************************************************/
 104          void CySpcStop(void) 
 105          {
 106   1          /* Save current global interrupt enable and disable it */
 107   1          uint8 interruptState = CyEnterCriticalSection();
 108   1      
 109   1          CY_SPC_PM_ACT_REG  &= ((uint8)(~PM_SPC_PM_EN));
 110   1          CY_SPC_PM_STBY_REG &= ((uint8)(~PM_SPC_PM_EN));
 111   1      
 112   1          /* Restore global interrupt enable state */
 113   1          CyExitCriticalSection(interruptState);
 114   1      }
 115          
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 3   

 116          
 117          /*******************************************************************************
 118          * Function Name: CySpcReadData
 119          ********************************************************************************
 120          * Summary:
 121          *  Reads data from the SPC.
 122          *
 123          * Parameters:
 124          *  uint8 buffer:
 125          *   Address to store data read.
 126          *
 127          *  uint8 size:
 128          *   Number of bytes to read from the SPC.
 129          *
 130          * Return:
 131          *  uint8:
 132          *   The number of bytes read from the SPC.
 133          *
 134          *******************************************************************************/
 135          uint8 CySpcReadData(uint8 buffer[], uint8 size) 
 136          {
 137   1          uint8 i;
 138   1      
 139   1          for(i = 0u; i < size; i++)
 140   1          {
 141   2              while(!CY_SPC_DATA_READY)
 142   2              {
 143   3                  CyDelayUs(1u);
 144   3              }
 145   2              buffer[i] = CY_SPC_CPU_DATA_REG;
 146   2          }
 147   1      
 148   1          return(i);
 149   1      }
 150          
 151          
 152          /*******************************************************************************
 153          * Function Name: CySpcLoadMultiByte
 154          ********************************************************************************
 155          * Summary:
 156          *  Loads 1 to 32 bytes of data into the row latch of a Flash/EEPROM array.
 157          *
 158          * Parameters:
 159          *  uint8 array:
 160          *   Id of the array.
 161          *
 162          *  uint16 address:
 163          *   Flash/eeprom addrress
 164          *
 165          *  uint8* buffer:
 166          *   Data to load to the row latch
 167          *
 168          *  uint16 number:
 169          *   Number bytes to load.
 170          *
 171          * Return:
 172          *  CYRET_STARTED
 173          *  CYRET_CANCELED
 174          *  CYRET_LOCKED
 175          *  CYRET_BAD_PARAM
 176          *
 177          *******************************************************************************/
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 4   

 178          cystatus CySpcLoadMultiByte(uint8 array, uint16 address, const uint8 buffer[], uint8 size) 
 179          {
 180   1          cystatus status = CYRET_STARTED;
 181   1          uint8 i;
 182   1      
 183   1          /***************************************************************************
 184   1          * Check if number is correct for array. Number must be less than
 185   1          * 32 for Flash or less than 16 for EEPROM.
 186   1          ***************************************************************************/
 187   1          if(((array < CY_SPC_LAST_FLASH_ARRAYID) && (size < 32u)) ||
 188   1             ((array > CY_SPC_LAST_FLASH_ARRAYID) && (size < 16u)))
 189   1          {
 190   2              if(CY_SPC_IDLE)
 191   2              {
 192   3                  CY_SPC_CPU_DATA_REG = CY_SPC_KEY_ONE;
 193   3                  CY_SPC_CPU_DATA_REG = CY_SPC_KEY_TWO(CY_SPC_CMD_LD_MULTI_BYTE);
 194   3                  CY_SPC_CPU_DATA_REG = CY_SPC_CMD_LD_MULTI_BYTE;
 195   3      
 196   3                  if(CY_SPC_BUSY)
 197   3                  {
 198   4                      CY_SPC_CPU_DATA_REG = array;
 199   4                      CY_SPC_CPU_DATA_REG = 1u & HI8(address);
 200   4                      CY_SPC_CPU_DATA_REG = LO8(address);
 201   4                      CY_SPC_CPU_DATA_REG = ((uint8)(size - 1u));
 202   4      
 203   4                      for(i = 0u; i < size; i++)
 204   4                      {
 205   5                          CY_SPC_CPU_DATA_REG = buffer[i];
 206   5                      }
 207   4                  }
 208   3                  else
 209   3                  {
 210   4                      status = CYRET_CANCELED;
 211   4                  }
 212   3              }
 213   2              else
 214   2              {
 215   3                  status = CYRET_LOCKED;
 216   3              }
 217   2          }
 218   1          else
 219   1          {
 220   2              status = CYRET_BAD_PARAM;
 221   2          }
 222   1      
 223   1          return(status);
 224   1      }
 225          
 226          
 227          /*******************************************************************************
 228          * Function Name: CySpcLoadRow
 229          ********************************************************************************
 230          * Summary:
 231          *  Loads a row of data into the row latch of a Flash/EEPROM array.
 232          *
 233          * Parameters:
 234          *  uint8 array:
 235          *   Id of the array.
 236          *
 237          *  uint8* buffer:
 238          *   Data to be loaded to the row latch
 239          *
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 5   

 240          *  uint8 size:
 241          *   The number of data bytes that the SPC expects to be written. Depends on the
 242          *   type of the array and, if the array is Flash, whether ECC is being enabled
 243          *   or not. There are following values: flash row latch size with ECC enabled,
 244          *   flash row latch size with ECC disabled and EEPROM row latch size.
 245          *
 246          * Return:
 247          *  CYRET_STARTED
 248          *  CYRET_CANCELED
 249          *  CYRET_LOCKED
 250          *
 251          *******************************************************************************/
 252          cystatus CySpcLoadRow(uint8 array, const uint8 buffer[], uint16 size)
 253          {
 254   1          cystatus status = CYRET_STARTED;
 255   1          uint16 i;
 256   1      
 257   1          /* Make sure the SPC is ready to accept command */
 258   1          if(CY_SPC_IDLE)
 259   1          {
 260   2              CY_SPC_CPU_DATA_REG = CY_SPC_KEY_ONE;
 261   2              CY_SPC_CPU_DATA_REG = CY_SPC_KEY_TWO(CY_SPC_CMD_LD_ROW);
 262   2              CY_SPC_CPU_DATA_REG = CY_SPC_CMD_LD_ROW;
 263   2      
 264   2              /* Make sure the command was accepted */
 265   2              if(CY_SPC_BUSY)
 266   2              {
 267   3                  CY_SPC_CPU_DATA_REG = array;
 268   3      
 269   3                  for(i = 0u; i < size; i++)
 270   3                  {
 271   4                      CY_SPC_CPU_DATA_REG = buffer[i];
 272   4                  }
 273   3              }
 274   2              else
 275   2              {
 276   3                  status = CYRET_CANCELED;
 277   3              }
 278   2          }
 279   1          else
 280   1          {
 281   2              status = CYRET_LOCKED;
 282   2          }
 283   1      
 284   1          return(status);
 285   1      }
 286          
 287          
 288          /*******************************************************************************
 289          * Function Name: CySpcWriteRow
 290          ********************************************************************************
 291          * Summary:
 292          *  Erases then programs a row in Flash/EEPROM with data in row latch.
 293          *
 294          * Parameters:
 295          *  uint8 array:
 296          *   Id of the array.
 297          *
 298          *  uint16 address:
 299          *   flash/eeprom addrress
 300          *
 301          *  uint8 tempPolarity:
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 6   

 302          *   temperature polarity.
 303          *   1: the Temp Magnitude is interpreted as a positive value
 304          *   0: the Temp Magnitude is interpreted as a negative value
 305          *
 306          *  uint8 tempMagnitude:
 307          *   temperature magnitude.
 308          *
 309          * Return:
 310          *  CYRET_STARTED
 311          *  CYRET_CANCELED
 312          *  CYRET_LOCKED
 313          *
 314          *******************************************************************************/
 315          cystatus CySpcWriteRow(uint8 array, uint16 address, uint8 tempPolarity, uint8 tempMagnitude)
 316          {
 317   1          cystatus status = CYRET_STARTED;
 318   1      
 319   1          /* Make sure the SPC is ready to accept command */
 320   1          if(CY_SPC_IDLE)
 321   1          {
 322   2              CY_SPC_CPU_DATA_REG = CY_SPC_KEY_ONE;
 323   2              CY_SPC_CPU_DATA_REG = CY_SPC_KEY_TWO(CY_SPC_CMD_WR_ROW);
 324   2              CY_SPC_CPU_DATA_REG = CY_SPC_CMD_WR_ROW;
 325   2      
 326   2              /* Make sure the command was accepted */
 327   2              if(CY_SPC_BUSY)
 328   2              {
 329   3                  CY_SPC_CPU_DATA_REG = array;
 330   3                  CY_SPC_CPU_DATA_REG = HI8(address);
 331   3                  CY_SPC_CPU_DATA_REG = LO8(address);
 332   3                  CY_SPC_CPU_DATA_REG = tempPolarity;
 333   3                  CY_SPC_CPU_DATA_REG = tempMagnitude;
 334   3              }
 335   2              else
 336   2              {
 337   3                  status = CYRET_CANCELED;
 338   3              }
 339   2          }
 340   1          else
 341   1          {
 342   2              status = CYRET_LOCKED;
 343   2          }
 344   1      
 345   1          return(status);
 346   1      }
 347          
 348          
 349          /*******************************************************************************
 350          * Function Name: CySpcEraseSector
 351          ********************************************************************************
 352          * Summary:
 353          *  Erases all data in the addressed sector (block of 64 rows).
 354          *
 355          * Parameters:
 356          *  uint8 array:
 357          *   Id of the array.
 358          *
 359          *  uint8 sectorNumber:
 360          *   Zero based sector number within Flash/EEPROM array
 361          *
 362          * Return:
 363          *  CYRET_STARTED
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 7   

 364          *  CYRET_CANCELED
 365          *  CYRET_LOCKED
 366          *
 367          *******************************************************************************/
 368          cystatus CySpcEraseSector(uint8 array, uint8 sectorNumber)
 369          {
 370   1          cystatus status = CYRET_STARTED;
 371   1      
 372   1          /* Make sure the SPC is ready to accept command */
 373   1          if(CY_SPC_IDLE)
 374   1          {
 375   2              CY_SPC_CPU_DATA_REG = CY_SPC_KEY_ONE;
 376   2              CY_SPC_CPU_DATA_REG = CY_SPC_KEY_TWO(CY_SPC_CMD_ER_SECTOR);
 377   2              CY_SPC_CPU_DATA_REG = CY_SPC_CMD_ER_SECTOR;
 378   2      
 379   2              /* Make sure the command was accepted */
 380   2              if(CY_SPC_BUSY)
 381   2              {
 382   3                  CY_SPC_CPU_DATA_REG = array;
 383   3                  CY_SPC_CPU_DATA_REG = sectorNumber;
 384   3              }
 385   2              else
 386   2              {
 387   3                  status = CYRET_CANCELED;
 388   3              }
 389   2          }
 390   1          else
 391   1          {
 392   2              status = CYRET_LOCKED;
 393   2          }
 394   1      
 395   1          return(status);
 396   1      }
 397          
 398          
 399          /*******************************************************************************
 400          * Function Name: CySpcGetTemp
 401          ********************************************************************************
 402          * Summary:
 403          *  Returns the internal die temperature
 404          *
 405          * Parameters:
 406          *  uint8 numSamples:
 407          *   Number of samples. Valid values are 1-5, resulting in 2 - 32 samples
 408          *   respectively.
 409          *
 410          * uint16 timerPeriod:
 411          *   Number of ADC ACLK cycles. A valid 14 bit value is accepted, higher 2 bits
 412          *   of 16 bit values are ignored.
 413          *
 414          * uint8 clkDivSelect:
 415          *   ADC ACLK clock divide value. Valid values are 2 - 225.
 416          *
 417          * Return:
 418          *  CYRET_STARTED
 419          *  CYRET_CANCELED
 420          *  CYRET_LOCKED
 421          *
 422          *******************************************************************************/
 423          #if(CY_PSOC5A)
              cystatus CySpcGetTemp(uint8 numSamples, uint16 timerPeriod, uint8 clkDivSelect)
              #else
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 8   

 426          cystatus CySpcGetTemp(uint8 numSamples)
 427          #endif  /* (CY_PSOC5A) */
 428          {
 429   1          cystatus status = CYRET_STARTED;
 430   1      
 431   1          /* Make sure the SPC is ready to accept command */
 432   1          if(CY_SPC_IDLE)
 433   1          {
 434   2              CY_SPC_CPU_DATA_REG = CY_SPC_KEY_ONE;
 435   2              CY_SPC_CPU_DATA_REG = CY_SPC_KEY_TWO(CY_SPC_CMD_GET_TEMP);
 436   2              CY_SPC_CPU_DATA_REG = CY_SPC_CMD_GET_TEMP;
 437   2      
 438   2              /* Make sure the command was accepted */
 439   2              if(CY_SPC_BUSY)
 440   2              {
 441   3                  CY_SPC_CPU_DATA_REG = numSamples;
 442   3      
 443   3                  #if(CY_PSOC5A)
                              CY_SPC_CPU_DATA_REG = HI8(timerPeriod);
                              CY_SPC_CPU_DATA_REG = LO8(timerPeriod);
                              CY_SPC_CPU_DATA_REG = clkDivSelect;
                          #endif  /* (CY_PSOC5A) */
 448   3              }
 449   2              else
 450   2              {
 451   3                  status = CYRET_CANCELED;
 452   3              }
 453   2          }
 454   1          else
 455   1          {
 456   2              status = CYRET_LOCKED;
 457   2          }
 458   1      
 459   1          return(status);
 460   1      }
 461          
 462          
 463          /*******************************************************************************
 464          * Function Name: CySpcLock
 465          ********************************************************************************
 466          * Summary:
 467          *  Locks the SPC so it can not be used by someone else:
 468          *   - Saves wait-pipeline enable state and enable pipeline (PSoC5)
 469          *
 470          * Parameters:
 471          *  Note
 472          *
 473          * Return:
 474          *  CYRET_SUCCESS - if the resource was free.
 475          *  CYRET_LOCKED  - if the SPC is in use.
 476          *
 477          *******************************************************************************/
 478          cystatus CySpcLock(void)
 479          {
 480   1          cystatus status = CYRET_LOCKED;
 481   1          uint8 interruptState;
 482   1      
 483   1          /* Enter critical section */
 484   1          interruptState = CyEnterCriticalSection();
 485   1      
 486   1          if(CY_SPC_UNLOCKED == SpcLockState)
 487   1          {
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 9   

 488   2              SpcLockState = CY_SPC_LOCKED;
 489   2              status = CYRET_SUCCESS;
 490   2      
 491   2              #if(CY_PSOC5LP)
              
                          if(0u != (CY_SPC_CPU_WAITPIPE_REG & CY_SPC_CPU_WAITPIPE_BYPASS))
                          {
                              /* Enable pipeline registers */
                              CY_SPC_CPU_WAITPIPE_REG &= ((uint32)(~CY_SPC_CPU_WAITPIPE_BYPASS));
              
                              /* At least 2 NOP instructions are recommended */
                              CY_NOP;
                              CY_NOP;
                              CY_NOP;
              
                              spcWaitPipeBypass = CY_SPC_CPU_WAITPIPE_BYPASS;
                          }
              
                      #endif  /* (CY_PSOC5LP) */
 507   2          }
 508   1      
 509   1          /* Exit critical section */
 510   1          CyExitCriticalSection(interruptState);
 511   1      
 512   1          return(status);
 513   1      }
 514          
 515          
 516          /*******************************************************************************
 517          * Function Name: CySpcUnlock
 518          ********************************************************************************
 519          * Summary:
 520          *  Unlocks the SPC so it can be used by someone else:
 521          *   - Restores wait-pipeline enable state (PSoC5)
 522          *
 523          * Parameters:
 524          *  None
 525          *
 526          * Return:
 527          *  None
 528          *
 529          *******************************************************************************/
 530          void CySpcUnlock(void)
 531          {
 532   1          uint8 interruptState;
 533   1      
 534   1          /* Enter critical section */
 535   1          interruptState = CyEnterCriticalSection();
 536   1      
 537   1          /* Release the SPC object */
 538   1          SpcLockState = CY_SPC_UNLOCKED;
 539   1      
 540   1          #if(CY_PSOC5LP)
              
                      if(CY_SPC_CPU_WAITPIPE_BYPASS == spcWaitPipeBypass)
                      {
                          /* Force to bypass pipeline registers */
                          CY_SPC_CPU_WAITPIPE_REG |= CY_SPC_CPU_WAITPIPE_BYPASS;
              
                          /* At least 2 NOP instructions are recommended */
                          CY_NOP;
                          CY_NOP;
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 10  

                          CY_NOP;
              
                          spcWaitPipeBypass = 0u;
                      }
              
                  #endif  /* (CY_PSOC5LP) */
 556   1      
 557   1          /* Exit critical section */
 558   1          CyExitCriticalSection(interruptState);
 559   1      }
 560          
 561          
 562          /* [] END OF FILE */
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 11  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION CySpcStart (BEGIN)
                                           ; SOURCE LINE # 78
                                           ; SOURCE LINE # 79
                                           ; SOURCE LINE # 81
0000 120000      E     LCALL   CyEnterCriticalSection
0003 900000      R     MOV     DPTR,#interruptState
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 83
0008 9043A0            MOV     DPTR,#043A0H
000B E0                MOVX    A,@DPTR
000C FF                MOV     R7,A
000D EF                MOV     A,R7
000E 4408              ORL     A,#08H
0010 FF                MOV     R7,A
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 84
0013 9043B0            MOV     DPTR,#043B0H
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 EF                MOV     A,R7
0019 4408              ORL     A,#08H
001B FF                MOV     R7,A
001C EF                MOV     A,R7
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 87
001E 900000      R     MOV     DPTR,#interruptState
0021 E0                MOVX    A,@DPTR
0022 FF                MOV     R7,A
0023 120000      E     LCALL   _CyExitCriticalSection
                                           ; SOURCE LINE # 88
0026 22                RET     
             ; FUNCTION CySpcStart (END)

             ; FUNCTION CySpcStop (BEGIN)
                                           ; SOURCE LINE # 104
                                           ; SOURCE LINE # 105
                                           ; SOURCE LINE # 107
0000 120000      E     LCALL   CyEnterCriticalSection
0003 900000      R     MOV     DPTR,#interruptState
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 109
0008 9043A0            MOV     DPTR,#043A0H
000B E0                MOVX    A,@DPTR
000C FF                MOV     R7,A
000D EF                MOV     A,R7
000E 54F7              ANL     A,#0F7H
0010 FF                MOV     R7,A
0011 EF                MOV     A,R7
0012 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 110
0013 9043B0            MOV     DPTR,#043B0H
0016 E0                MOVX    A,@DPTR
0017 FF                MOV     R7,A
0018 EF                MOV     A,R7
0019 54F7              ANL     A,#0F7H
001B FF                MOV     R7,A
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 12  

001C EF                MOV     A,R7
001D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 113
001E 900000      R     MOV     DPTR,#interruptState
0021 E0                MOVX    A,@DPTR
0022 FF                MOV     R7,A
0023 120000      E     LCALL   _CyExitCriticalSection
                                           ; SOURCE LINE # 114
0026 22                RET     
             ; FUNCTION CySpcStop (END)

             ; FUNCTION _CySpcReadData (BEGIN)
                                           ; SOURCE LINE # 135
0000 900000      R     MOV     DPTR,#buffer
0003 120000      E     LCALL   ?C?PSTXDATA
0006 900000      R     MOV     DPTR,#size
0009 ED                MOV     A,R5
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 136
                                           ; SOURCE LINE # 139
000B 900000      R     MOV     DPTR,#i
000E E4                CLR     A
000F F0                MOVX    @DPTR,A
0010         ?C0003:
0010 900000      R     MOV     DPTR,#size
0013 E0                MOVX    A,@DPTR
0014 FF                MOV     R7,A
0015 900000      R     MOV     DPTR,#i
0018 E0                MOVX    A,@DPTR
0019 FE                MOV     R6,A
001A EE                MOV     A,R6
001B C3                CLR     C
001C 9F                SUBB    A,R7
001D 5040              JNC     ?C0004
                                           ; SOURCE LINE # 140
001F         ?C0006:
                                           ; SOURCE LINE # 141
001F 904722            MOV     DPTR,#04722H
0022 E0                MOVX    A,@DPTR
0023 FF                MOV     R7,A
0024 EF                MOV     A,R7
0025 5401              ANL     A,#01H
0027 FF                MOV     R7,A
0028 7E00              MOV     R6,#00H
002A EF                MOV     A,R7
002B 4E                ORL     A,R6
002C 6003              JZ      ?C0008
002E D3                SETB    C
002F 8001              SJMP    ?C0009
0031         ?C0008:
0031 C3                CLR     C
0032         ?C0009:
0032 4009              JC      ?C0007
                                           ; SOURCE LINE # 142
                                           ; SOURCE LINE # 143
0034 7F01              MOV     R7,#01H
0036 7E00              MOV     R6,#00H
0038 120000      E     LCALL   _CyDelayUs
                                           ; SOURCE LINE # 144
003B 80E2              SJMP    ?C0006
003D         ?C0007:
                                           ; SOURCE LINE # 145
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 13  

003D 904720            MOV     DPTR,#04720H
0040 E0                MOVX    A,@DPTR
0041 FF                MOV     R7,A
0042 900000      R     MOV     DPTR,#buffer
0045 120000      E     LCALL   ?C?PLDXDATA
0048 900000      R     MOV     DPTR,#i
004B E0                MOVX    A,@DPTR
004C FE                MOV     R6,A
004D E9                MOV     A,R1
004E 2E                ADD     A,R6
004F F9                MOV     R1,A
0050 E4                CLR     A
0051 3A                ADDC    A,R2
0052 FA                MOV     R2,A
0053 EF                MOV     A,R7
0054 120000      E     LCALL   ?C?CSTPTR
                                           ; SOURCE LINE # 146
0057 900000      R     MOV     DPTR,#i
005A E0                MOVX    A,@DPTR
005B 04                INC     A
005C F0                MOVX    @DPTR,A
005D 80B1              SJMP    ?C0003
005F         ?C0004:
                                           ; SOURCE LINE # 148
005F 900000      R     MOV     DPTR,#i
0062 E0                MOVX    A,@DPTR
0063 FF                MOV     R7,A
                                           ; SOURCE LINE # 149
0064         ?C0010:
0064 22                RET     
             ; FUNCTION _CySpcReadData (END)

             ; FUNCTION _CySpcLoadMultiByte (BEGIN)
                                           ; SOURCE LINE # 178
0000 900000      R     MOV     DPTR,#array
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 900000      R     MOV     DPTR,#address
0008 EC                MOV     A,R4
0009 F0                MOVX    @DPTR,A
000A A3                INC     DPTR
000B ED                MOV     A,R5
000C F0                MOVX    @DPTR,A
000D 900000      R     MOV     DPTR,#buffer
0010 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 179
                                           ; SOURCE LINE # 180
0013 900000      R     MOV     DPTR,#status
0016 7407              MOV     A,#07H
0018 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 187
0019 900000      R     MOV     DPTR,#array
001C E0                MOVX    A,@DPTR
001D FF                MOV     R7,A
001E EF                MOV     A,R7
001F C3                CLR     C
0020 943F              SUBB    A,#03FH
0022 500B              JNC     ?C0013
0024 900000      R     MOV     DPTR,#size
0027 E0                MOVX    A,@DPTR
0028 FF                MOV     R7,A
0029 EF                MOV     A,R7
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 14  

002A C3                CLR     C
002B 9420              SUBB    A,#020H
002D 401C              JC      ?C0012
002F         ?C0013:
002F 900000      R     MOV     DPTR,#array
0032 E0                MOVX    A,@DPTR
0033 FF                MOV     R7,A
0034 EF                MOV     A,R7
0035 D3                SETB    C
0036 943F              SUBB    A,#03FH
0038 5003              JNC     $ + 5H
003A 020000      R     LJMP    ?C0011
003D 900000      R     MOV     DPTR,#size
0040 E0                MOVX    A,@DPTR
0041 FF                MOV     R7,A
0042 EF                MOV     A,R7
0043 C3                CLR     C
0044 9410              SUBB    A,#010H
0046 4003              JC      $ + 5H
0048 020000      R     LJMP    ?C0011
004B         ?C0012:
                                           ; SOURCE LINE # 189
                                           ; SOURCE LINE # 190
004B 904722            MOV     DPTR,#04722H
004E E0                MOVX    A,@DPTR
004F FF                MOV     R7,A
0050 EF                MOV     A,R7
0051 5402              ANL     A,#02H
0053 FF                MOV     R7,A
0054 7E00              MOV     R6,#00H
0056 EF                MOV     A,R7
0057 4E                ORL     A,R6
0058 7003              JNZ     $ + 5H
005A 020000      R     LJMP    ?C0014
                                           ; SOURCE LINE # 191
                                           ; SOURCE LINE # 192
005D 904720            MOV     DPTR,#04720H
0060 74B6              MOV     A,#0B6H
0062 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 193
0063 904720            MOV     DPTR,#04720H
0066 74D4              MOV     A,#0D4H
0068 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 194
0069 904720            MOV     DPTR,#04720H
006C 7401              MOV     A,#01H
006E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 196
006F 904722            MOV     DPTR,#04722H
0072 E0                MOVX    A,@DPTR
0073 FF                MOV     R7,A
0074 EF                MOV     A,R7
0075 5402              ANL     A,#02H
0077 FF                MOV     R7,A
0078 7E00              MOV     R6,#00H
007A EF                MOV     A,R7
007B 4E                ORL     A,R6
007C 706F              JNZ     ?C0015
                                           ; SOURCE LINE # 197
                                           ; SOURCE LINE # 198
007E 900000      R     MOV     DPTR,#array
0081 E0                MOVX    A,@DPTR
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 15  

0082 FF                MOV     R7,A
0083 904720            MOV     DPTR,#04720H
0086 EF                MOV     A,R7
0087 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 199
0088 900000      R     MOV     DPTR,#address
008B E0                MOVX    A,@DPTR
008C FE                MOV     R6,A
008D A3                INC     DPTR
008E E0                MOVX    A,@DPTR
008F FF                MOV     R7,A
0090 EE                MOV     A,R6
0091 FF                MOV     R7,A
0092 7E00              MOV     R6,#00H
0094 EF                MOV     A,R7
0095 5401              ANL     A,#01H
0097 FF                MOV     R7,A
0098 904720            MOV     DPTR,#04720H
009B EF                MOV     A,R7
009C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 200
009D 900000      R     MOV     DPTR,#address
00A0 E0                MOVX    A,@DPTR
00A1 FE                MOV     R6,A
00A2 A3                INC     DPTR
00A3 E0                MOVX    A,@DPTR
00A4 FF                MOV     R7,A
00A5 904720            MOV     DPTR,#04720H
00A8 EF                MOV     A,R7
00A9 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 201
00AA 900000      R     MOV     DPTR,#size
00AD E0                MOVX    A,@DPTR
00AE FF                MOV     R7,A
00AF EF                MOV     A,R7
00B0 14                DEC     A
00B1 FF                MOV     R7,A
00B2 904720            MOV     DPTR,#04720H
00B5 EF                MOV     A,R7
00B6 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 203
00B7 900000      R     MOV     DPTR,#i
00BA E4                CLR     A
00BB F0                MOVX    @DPTR,A
00BC         ?C0016:
00BC 900000      R     MOV     DPTR,#size
00BF E0                MOVX    A,@DPTR
00C0 FF                MOV     R7,A
00C1 900000      R     MOV     DPTR,#i
00C4 E0                MOVX    A,@DPTR
00C5 FE                MOV     R6,A
00C6 EE                MOV     A,R6
00C7 C3                CLR     C
00C8 9F                SUBB    A,R7
00C9 5038              JNC     ?C0021
                                           ; SOURCE LINE # 204
                                           ; SOURCE LINE # 205
00CB 900000      R     MOV     DPTR,#buffer
00CE 120000      E     LCALL   ?C?PLDXDATA
00D1 900000      R     MOV     DPTR,#i
00D4 E0                MOVX    A,@DPTR
00D5 FF                MOV     R7,A
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 16  

00D6 E9                MOV     A,R1
00D7 2F                ADD     A,R7
00D8 F9                MOV     R1,A
00D9 E4                CLR     A
00DA 3A                ADDC    A,R2
00DB FA                MOV     R2,A
00DC 120000      E     LCALL   ?C?CLDPTR
00DF FF                MOV     R7,A
00E0 904720            MOV     DPTR,#04720H
00E3 EF                MOV     A,R7
00E4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 206
00E5 900000      R     MOV     DPTR,#i
00E8 E0                MOVX    A,@DPTR
00E9 04                INC     A
00EA F0                MOVX    @DPTR,A
00EB 80CF              SJMP    ?C0016
                                           ; SOURCE LINE # 207
00ED         ?C0015:
                                           ; SOURCE LINE # 209
                                           ; SOURCE LINE # 210
00ED 900000      R     MOV     DPTR,#status
00F0 7409              MOV     A,#09H
00F2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 211
                                           ; SOURCE LINE # 212
00F3 800E              SJMP    ?C0021
00F5         ?C0014:
                                           ; SOURCE LINE # 214
                                           ; SOURCE LINE # 215
00F5 900000      R     MOV     DPTR,#status
00F8 7404              MOV     A,#04H
00FA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 216
                                           ; SOURCE LINE # 217
00FB 8006              SJMP    ?C0021
00FD         ?C0011:
                                           ; SOURCE LINE # 219
                                           ; SOURCE LINE # 220
00FD 900000      R     MOV     DPTR,#status
0100 7401              MOV     A,#01H
0102 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 221
0103         ?C0021:
                                           ; SOURCE LINE # 223
0103 900000      R     MOV     DPTR,#status
0106 E0                MOVX    A,@DPTR
0107 FF                MOV     R7,A
                                           ; SOURCE LINE # 224
0108         ?C0022:
0108 22                RET     
             ; FUNCTION _CySpcLoadMultiByte (END)

             ; FUNCTION _CySpcLoadRow (BEGIN)
                                           ; SOURCE LINE # 252
0000 900000      R     MOV     DPTR,#array
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 900000      R     MOV     DPTR,#buffer
0008 120000      E     LCALL   ?C?PSTXDATA
                                           ; SOURCE LINE # 253
                                           ; SOURCE LINE # 254
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 17  

000B 900000      R     MOV     DPTR,#status
000E 7407              MOV     A,#07H
0010 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 258
0011 904722            MOV     DPTR,#04722H
0014 E0                MOVX    A,@DPTR
0015 FF                MOV     R7,A
0016 EF                MOV     A,R7
0017 5402              ANL     A,#02H
0019 FF                MOV     R7,A
001A 7E00              MOV     R6,#00H
001C EF                MOV     A,R7
001D 4E                ORL     A,R6
001E 607B              JZ      ?C0023
                                           ; SOURCE LINE # 259
                                           ; SOURCE LINE # 260
0020 904720            MOV     DPTR,#04720H
0023 74B6              MOV     A,#0B6H
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 261
0026 904720            MOV     DPTR,#04720H
0029 74D5              MOV     A,#0D5H
002B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 262
002C 904720            MOV     DPTR,#04720H
002F 7402              MOV     A,#02H
0031 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 265
0032 904722            MOV     DPTR,#04722H
0035 E0                MOVX    A,@DPTR
0036 FF                MOV     R7,A
0037 EF                MOV     A,R7
0038 5402              ANL     A,#02H
003A FF                MOV     R7,A
003B 7E00              MOV     R6,#00H
003D EF                MOV     A,R7
003E 4E                ORL     A,R6
003F 7052              JNZ     ?C0024
                                           ; SOURCE LINE # 266
                                           ; SOURCE LINE # 267
0041 900000      R     MOV     DPTR,#array
0044 E0                MOVX    A,@DPTR
0045 FF                MOV     R7,A
0046 904720            MOV     DPTR,#04720H
0049 EF                MOV     A,R7
004A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 269
004B 900000      R     MOV     DPTR,#i
004E E4                CLR     A
004F F0                MOVX    @DPTR,A
0050 A3                INC     DPTR
0051 E4                CLR     A
0052 F0                MOVX    @DPTR,A
0053         ?C0025:
0053 900000      R     MOV     DPTR,#size
0056 E0                MOVX    A,@DPTR
0057 FE                MOV     R6,A
0058 A3                INC     DPTR
0059 E0                MOVX    A,@DPTR
005A FF                MOV     R7,A
005B 900000      R     MOV     DPTR,#i
005E E0                MOVX    A,@DPTR
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 18  

005F FC                MOV     R4,A
0060 A3                INC     DPTR
0061 E0                MOVX    A,@DPTR
0062 FD                MOV     R5,A
0063 C3                CLR     C
0064 ED                MOV     A,R5
0065 9F                SUBB    A,R7
0066 EC                MOV     A,R4
0067 9E                SUBB    A,R6
0068 5037              JNC     ?C0029
                                           ; SOURCE LINE # 270
                                           ; SOURCE LINE # 271
006A 900000      R     MOV     DPTR,#buffer
006D 120000      E     LCALL   ?C?PLDXDATA
0070 900000      R     MOV     DPTR,#i
0073 E0                MOVX    A,@DPTR
0074 FE                MOV     R6,A
0075 A3                INC     DPTR
0076 E0                MOVX    A,@DPTR
0077 FF                MOV     R7,A
0078 E9                MOV     A,R1
0079 2F                ADD     A,R7
007A F9                MOV     R1,A
007B EA                MOV     A,R2
007C 3E                ADDC    A,R6
007D FA                MOV     R2,A
007E 120000      E     LCALL   ?C?CLDPTR
0081 FF                MOV     R7,A
0082 904720            MOV     DPTR,#04720H
0085 EF                MOV     A,R7
0086 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 272
0087 900000      R     MOV     DPTR,#i
008A E4                CLR     A
008B 75F001            MOV     B,#01H
008E 120000      E     LCALL   ?C?IILDX
0091 80C0              SJMP    ?C0025
                                           ; SOURCE LINE # 273
0093         ?C0024:
                                           ; SOURCE LINE # 275
                                           ; SOURCE LINE # 276
0093 900000      R     MOV     DPTR,#status
0096 7409              MOV     A,#09H
0098 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 277
                                           ; SOURCE LINE # 278
0099 8006              SJMP    ?C0029
009B         ?C0023:
                                           ; SOURCE LINE # 280
                                           ; SOURCE LINE # 281
009B 900000      R     MOV     DPTR,#status
009E 7404              MOV     A,#04H
00A0 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 282
00A1         ?C0029:
                                           ; SOURCE LINE # 284
00A1 900000      R     MOV     DPTR,#status
00A4 E0                MOVX    A,@DPTR
00A5 FF                MOV     R7,A
                                           ; SOURCE LINE # 285
00A6         ?C0030:
00A6 22                RET     
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 19  

             ; FUNCTION _CySpcLoadRow (END)

             ; FUNCTION _CySpcWriteRow (BEGIN)
                                           ; SOURCE LINE # 315
0000 900000      R     MOV     DPTR,#array
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 900000      R     MOV     DPTR,#address
0008 EC                MOV     A,R4
0009 F0                MOVX    @DPTR,A
000A A3                INC     DPTR
000B ED                MOV     A,R5
000C F0                MOVX    @DPTR,A
000D 900000      R     MOV     DPTR,#tempPolarity
0010 EB                MOV     A,R3
0011 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 316
                                           ; SOURCE LINE # 317
0012 900000      R     MOV     DPTR,#status
0015 7407              MOV     A,#07H
0017 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 320
0018 904722            MOV     DPTR,#04722H
001B E0                MOVX    A,@DPTR
001C FF                MOV     R7,A
001D EF                MOV     A,R7
001E 5402              ANL     A,#02H
0020 FF                MOV     R7,A
0021 7E00              MOV     R6,#00H
0023 EF                MOV     A,R7
0024 4E                ORL     A,R6
0025 6067              JZ      ?C0031
                                           ; SOURCE LINE # 321
                                           ; SOURCE LINE # 322
0027 904720            MOV     DPTR,#04720H
002A 74B6              MOV     A,#0B6H
002C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 323
002D 904720            MOV     DPTR,#04720H
0030 74D8              MOV     A,#0D8H
0032 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 324
0033 904720            MOV     DPTR,#04720H
0036 7405              MOV     A,#05H
0038 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 327
0039 904722            MOV     DPTR,#04722H
003C E0                MOVX    A,@DPTR
003D FF                MOV     R7,A
003E EF                MOV     A,R7
003F 5402              ANL     A,#02H
0041 FF                MOV     R7,A
0042 7E00              MOV     R6,#00H
0044 EF                MOV     A,R7
0045 4E                ORL     A,R6
0046 703E              JNZ     ?C0032
                                           ; SOURCE LINE # 328
                                           ; SOURCE LINE # 329
0048 900000      R     MOV     DPTR,#array
004B E0                MOVX    A,@DPTR
004C FF                MOV     R7,A
004D 904720            MOV     DPTR,#04720H
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 20  

0050 EF                MOV     A,R7
0051 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 330
0052 900000      R     MOV     DPTR,#address
0055 E0                MOVX    A,@DPTR
0056 FE                MOV     R6,A
0057 A3                INC     DPTR
0058 E0                MOVX    A,@DPTR
0059 FF                MOV     R7,A
005A EE                MOV     A,R6
005B FF                MOV     R7,A
005C 7E00              MOV     R6,#00H
005E 904720            MOV     DPTR,#04720H
0061 EF                MOV     A,R7
0062 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 331
0063 900000      R     MOV     DPTR,#address
0066 E0                MOVX    A,@DPTR
0067 FE                MOV     R6,A
0068 A3                INC     DPTR
0069 E0                MOVX    A,@DPTR
006A FF                MOV     R7,A
006B 904720            MOV     DPTR,#04720H
006E EF                MOV     A,R7
006F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 332
0070 900000      R     MOV     DPTR,#tempPolarity
0073 E0                MOVX    A,@DPTR
0074 FF                MOV     R7,A
0075 904720            MOV     DPTR,#04720H
0078 EF                MOV     A,R7
0079 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 333
007A 900000      R     MOV     DPTR,#tempMagnitude
007D E0                MOVX    A,@DPTR
007E FF                MOV     R7,A
007F 904720            MOV     DPTR,#04720H
0082 EF                MOV     A,R7
0083 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 334
0084 800E              SJMP    ?C0034
0086         ?C0032:
                                           ; SOURCE LINE # 336
                                           ; SOURCE LINE # 337
0086 900000      R     MOV     DPTR,#status
0089 7409              MOV     A,#09H
008B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 338
                                           ; SOURCE LINE # 339
008C 8006              SJMP    ?C0034
008E         ?C0031:
                                           ; SOURCE LINE # 341
                                           ; SOURCE LINE # 342
008E 900000      R     MOV     DPTR,#status
0091 7404              MOV     A,#04H
0093 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 343
0094         ?C0034:
                                           ; SOURCE LINE # 345
0094 900000      R     MOV     DPTR,#status
0097 E0                MOVX    A,@DPTR
0098 FF                MOV     R7,A
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 21  

                                           ; SOURCE LINE # 346
0099         ?C0035:
0099 22                RET     
             ; FUNCTION _CySpcWriteRow (END)

             ; FUNCTION _CySpcEraseSector (BEGIN)
                                           ; SOURCE LINE # 368
0000 900000      R     MOV     DPTR,#array
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
0005 900000      R     MOV     DPTR,#sectorNumber
0008 ED                MOV     A,R5
0009 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 369
                                           ; SOURCE LINE # 370
000A 900000      R     MOV     DPTR,#status
000D 7407              MOV     A,#07H
000F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 373
0010 904722            MOV     DPTR,#04722H
0013 E0                MOVX    A,@DPTR
0014 FF                MOV     R7,A
0015 EF                MOV     A,R7
0016 5402              ANL     A,#02H
0018 FF                MOV     R7,A
0019 7E00              MOV     R6,#00H
001B EF                MOV     A,R7
001C 4E                ORL     A,R6
001D 603F              JZ      ?C0036
                                           ; SOURCE LINE # 374
                                           ; SOURCE LINE # 375
001F 904720            MOV     DPTR,#04720H
0022 74B6              MOV     A,#0B6H
0024 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 376
0025 904720            MOV     DPTR,#04720H
0028 74DB              MOV     A,#0DBH
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 377
002B 904720            MOV     DPTR,#04720H
002E 7408              MOV     A,#08H
0030 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 380
0031 904722            MOV     DPTR,#04722H
0034 E0                MOVX    A,@DPTR
0035 FF                MOV     R7,A
0036 EF                MOV     A,R7
0037 5402              ANL     A,#02H
0039 FF                MOV     R7,A
003A 7E00              MOV     R6,#00H
003C EF                MOV     A,R7
003D 4E                ORL     A,R6
003E 7016              JNZ     ?C0037
                                           ; SOURCE LINE # 381
                                           ; SOURCE LINE # 382
0040 900000      R     MOV     DPTR,#array
0043 E0                MOVX    A,@DPTR
0044 FF                MOV     R7,A
0045 904720            MOV     DPTR,#04720H
0048 EF                MOV     A,R7
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 383
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 22  

004A 900000      R     MOV     DPTR,#sectorNumber
004D E0                MOVX    A,@DPTR
004E FF                MOV     R7,A
004F 904720            MOV     DPTR,#04720H
0052 EF                MOV     A,R7
0053 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 384
0054 800E              SJMP    ?C0039
0056         ?C0037:
                                           ; SOURCE LINE # 386
                                           ; SOURCE LINE # 387
0056 900000      R     MOV     DPTR,#status
0059 7409              MOV     A,#09H
005B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 388
                                           ; SOURCE LINE # 389
005C 8006              SJMP    ?C0039
005E         ?C0036:
                                           ; SOURCE LINE # 391
                                           ; SOURCE LINE # 392
005E 900000      R     MOV     DPTR,#status
0061 7404              MOV     A,#04H
0063 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 393
0064         ?C0039:
                                           ; SOURCE LINE # 395
0064 900000      R     MOV     DPTR,#status
0067 E0                MOVX    A,@DPTR
0068 FF                MOV     R7,A
                                           ; SOURCE LINE # 396
0069         ?C0040:
0069 22                RET     
             ; FUNCTION _CySpcEraseSector (END)

             ; FUNCTION _CySpcGetTemp (BEGIN)
                                           ; SOURCE LINE # 426
0000 900000      R     MOV     DPTR,#numSamples
0003 EF                MOV     A,R7
0004 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 428
                                           ; SOURCE LINE # 429
0005 900000      R     MOV     DPTR,#status
0008 7407              MOV     A,#07H
000A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 432
000B 904722            MOV     DPTR,#04722H
000E E0                MOVX    A,@DPTR
000F FF                MOV     R7,A
0010 EF                MOV     A,R7
0011 5402              ANL     A,#02H
0013 FF                MOV     R7,A
0014 7E00              MOV     R6,#00H
0016 EF                MOV     A,R7
0017 4E                ORL     A,R6
0018 6035              JZ      ?C0041
                                           ; SOURCE LINE # 433
                                           ; SOURCE LINE # 434
001A 904720            MOV     DPTR,#04720H
001D 74B6              MOV     A,#0B6H
001F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 435
0020 904720            MOV     DPTR,#04720H
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 23  

0023 74E1              MOV     A,#0E1H
0025 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 436
0026 904720            MOV     DPTR,#04720H
0029 740E              MOV     A,#0EH
002B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 439
002C 904722            MOV     DPTR,#04722H
002F E0                MOVX    A,@DPTR
0030 FF                MOV     R7,A
0031 EF                MOV     A,R7
0032 5402              ANL     A,#02H
0034 FF                MOV     R7,A
0035 7E00              MOV     R6,#00H
0037 EF                MOV     A,R7
0038 4E                ORL     A,R6
0039 700C              JNZ     ?C0042
                                           ; SOURCE LINE # 440
                                           ; SOURCE LINE # 441
003B 900000      R     MOV     DPTR,#numSamples
003E E0                MOVX    A,@DPTR
003F FF                MOV     R7,A
0040 904720            MOV     DPTR,#04720H
0043 EF                MOV     A,R7
0044 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 448
0045 800E              SJMP    ?C0044
0047         ?C0042:
                                           ; SOURCE LINE # 450
                                           ; SOURCE LINE # 451
0047 900000      R     MOV     DPTR,#status
004A 7409              MOV     A,#09H
004C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 452
                                           ; SOURCE LINE # 453
004D 8006              SJMP    ?C0044
004F         ?C0041:
                                           ; SOURCE LINE # 455
                                           ; SOURCE LINE # 456
004F 900000      R     MOV     DPTR,#status
0052 7404              MOV     A,#04H
0054 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 457
0055         ?C0044:
                                           ; SOURCE LINE # 459
0055 900000      R     MOV     DPTR,#status
0058 E0                MOVX    A,@DPTR
0059 FF                MOV     R7,A
                                           ; SOURCE LINE # 460
005A         ?C0045:
005A 22                RET     
             ; FUNCTION _CySpcGetTemp (END)

             ; FUNCTION CySpcLock (BEGIN)
                                           ; SOURCE LINE # 478
                                           ; SOURCE LINE # 479
                                           ; SOURCE LINE # 480
0000 900000      R     MOV     DPTR,#status
0003 7404              MOV     A,#04H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 484
0006 120000      E     LCALL   CyEnterCriticalSection
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 24  

0009 900000      R     MOV     DPTR,#interruptState
000C EF                MOV     A,R7
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 486
000E 900000      R     MOV     DPTR,#SpcLockState
0011 E0                MOVX    A,@DPTR
0012 FF                MOV     R7,A
0013 EF                MOV     A,R7
0014 700B              JNZ     ?C0046
                                           ; SOURCE LINE # 487
                                           ; SOURCE LINE # 488
0016 900000      R     MOV     DPTR,#SpcLockState
0019 7401              MOV     A,#01H
001B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 489
001C 900000      R     MOV     DPTR,#status
001F E4                CLR     A
0020 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 507
0021         ?C0046:
                                           ; SOURCE LINE # 510
0021 900000      R     MOV     DPTR,#interruptState
0024 E0                MOVX    A,@DPTR
0025 FF                MOV     R7,A
0026 120000      E     LCALL   _CyExitCriticalSection
                                           ; SOURCE LINE # 512
0029 900000      R     MOV     DPTR,#status
002C E0                MOVX    A,@DPTR
002D FF                MOV     R7,A
                                           ; SOURCE LINE # 513
002E         ?C0047:
002E 22                RET     
             ; FUNCTION CySpcLock (END)

             ; FUNCTION CySpcUnlock (BEGIN)
                                           ; SOURCE LINE # 530
                                           ; SOURCE LINE # 531
                                           ; SOURCE LINE # 535
0000 120000      E     LCALL   CyEnterCriticalSection
0003 900000      R     MOV     DPTR,#interruptState
0006 EF                MOV     A,R7
0007 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 538
0008 900000      R     MOV     DPTR,#SpcLockState
000B E4                CLR     A
000C F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 558
000D 900000      R     MOV     DPTR,#interruptState
0010 E0                MOVX    A,@DPTR
0011 FF                MOV     R7,A
0012 120000      E     LCALL   _CyExitCriticalSection
                                           ; SOURCE LINE # 559
0015 22                RET     
             ; FUNCTION CySpcUnlock (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1031    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      1      39
   PDATA SIZE       =   ----    ----
C51 COMPILER V9.03   CYSPC                                                                 08/11/2013 22:22:03 PAGE 25  

   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
